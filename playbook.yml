- hosts: Projeto-app
  become: yes
  tasks: 
    # - name: Git Clone do app
    #   git:
    #     repo: https://github.com/kauanvarella/app.git
    #     dest: /home/ubuntu/app
    #     clone: yes
    #     version: master
    #     update: yes      

    # - name: Web Server
    #   docker_container:
    #     name: app
    #     image: webdevops/php-apache:alpine-php7
    #     state: started
    #     ports:
    #       - "80:80"
    #     volumes:
    #       - /home/ubuntu/app/www:/app

    - name: Database
      docker_container:
        name: db
        image: mysql
        command: --default-authentication-plugin=mysql_native_password    
        volumes:
          - /home/ubuntu/mysqldb:/var/lib/mysql
        restart: true
        env:
          MYSQL_ROOT_PASSWORD: root
        ports:
          - "3306:3306"

    - name: Criando database e tabela
      shell: docker exec -it db bash 
      shell: mysql -u root -p $MYSQL_ROOT_PASSWORD
      # shell: create database db_projeto;
      # shell: use db_projeto;
      # shell: create table login (COD INT NOT NULL AUTO_INCREMENT PRIMARY KEY, USUARIO VARCHAR(50) NOT NULL, SENHA VARCHAR(50) NOT NULL);
      # shell: insert into login (USUARIO, SENHA) values ('docker', '123');